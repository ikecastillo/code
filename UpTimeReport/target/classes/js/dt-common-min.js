AJS.$.namespace("DT.gadget.fields");DTGADGET.projectPicker=function(b,a,c){return{userpref:a,label:b.getMsg("gadget.common.project.label"),id:"project_picker_"+a,type:"callbackBuilder",callback:function(e){e.append(AJS.$("<select/>").attr({id:a,name:a}).addClass("select"));var d=AJS.$("#"+a);d.empty();var f=b.getPref(a);AJS.$(c).each(function(){var g=AJS.$("<option/>").attr("value",this.key).text(this.name);d.append(g);if(this.key==f){g.attr({selected:"selected"});selectedProjectId=this.key}})}}};DTGADGET.updateVersionSelectionOptions=function(f,e,d,c){var b=AJS.$("#"+d);b.empty();var a=AJS.$.ajax({key:"versions",url:"/rest/api/2/project/"+e+"/versions",contentType:"application/json",success:function(h){var g=f.getPref(d).split("|");console.log("Selected Versions: "+g.toString());a=h;if(c){a.unshift({id:"All",name:"All Versions"})}AJS.$(a).each(function(){var k=AJS.$("<option/>").attr("value",this.id).text(this.name);b.append(k);for(var m=0,j=g.length;m<j;m++){if(g[m]==this.id){k.attr("selected","selected")}}})}});console.log(b)};DTGADGET.versionPicker=function(e,a,d,b,c){return{userpref:d,label:e.getMsg("Version"),id:"version_picker_"+d,type:"callbackBuilder",callback:function(i){var f={id:d,name:d};var h="select";if(b){f.multiple="multiple";f.size="4";h="multi-select"}i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+a);DTGADGET.updateVersionSelectionOptions(e,g.val(),d,c);g.change(function(j){DTGADGET.updateVersionSelectionOptions(e,g.val(),d,c)})}}};DTGADGET.updateSprintSelectionOptions=function(f,e,b,c){e="project="+e;var a=AJS.$("#"+b);a.empty();var d=AJS.$.ajax({key:"sprints",url:"/rest/greenhopper/1.0/integration/teamcalendars/sprint/list",contentType:"application/json",data:{jql:e,returnIds:true},success:function(h){var g=f.getPref(b).split("|");d=h.sprints;if(c){d.unshift({id:"All",name:"All Sprints"})}AJS.$(d).each(function(){var k=AJS.$("<option/>").attr("value",this.id).text(this.name);a.append(k);for(var m=0,j=g.length;m<j;m++){if(g[m]==this.id){k.attr("selected","selected")}}})}})};DTGADGET.sprintPicker=function(e,b,c,a,d){return{userpref:c,label:e.getMsg("Sprint"),id:"sprint_picker_"+c,type:"callbackBuilder",callback:function(i){var f={id:c,name:c};var h="select";if(a){f.multiple="multiple";f.size="4";h="multi-select"}i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+b);DTGADGET.updateSprintSelectionOptions(e,g.val(),c,d);g.change(function(j){DTGADGET.updateSprintSelectionOptions(e,g.val(),c,d)})}}};DTGADGET.updateReleaseSelectionOptions=function(f,e,d,c){var b=AJS.$("#"+d);b.empty();var a=AJS.$.ajax({key:"versions",url:"/rest/dealertrackqmetry/1.0/testexecutionstatus/getVersions.json?project="+e,contentType:"application/json",success:function(h){var g=f.getPref(d).split("|");console.log("Selected Versions: "+g.toString());a=h;if(c){a.unshift({id:"All",name:"All Versions"})}AJS.$(a).each(function(){var k=AJS.$("<option/>").attr("value",this.id).text(this.name);b.append(k);for(var m=0,j=g.length;m<j;m++){if(g[m]==this.id){k.attr("selected","selected")}}})}});console.log(b)};DTGADGET.releasePicker=function(e,a,d,b,c){return{userpref:d,label:"Release",id:"version_picker_"+d,type:"callbackBuilder",callback:function(i){var f={id:d,name:d};var h="select";if(b){f.multiple="multiple";f.size="4";h="multi-select"}i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+a);DTGADGET.updateReleaseSelectionOptions(e,g.val(),d,c);g.change(function(j){DTGADGET.updateReleaseSelectionOptions(e,g.val(),d,c)})}}};DTGADGET.updateIssueTypeSelectionOptions=function(f,e,d,c){var b=AJS.$("#"+d);b.empty();var a=AJS.$.ajax({key:"issueTypes",url:"/rest/dealertrack/1.0/getIssueTypes.json?projectkey="+e,contentType:"application/json",success:function(h){var g=f.getPref(d).split("|");console.log("Selected getIssueTypes: "+g.toString());a=h;if(c){a.unshift({label:"All",value:"All Versions"})}AJS.$(a).each(function(){var k=AJS.$("<option/>").attr("value",this.label).text(this.value);b.append(k);for(var m=0,j=g.length;m<j;m++){if(g[m]==this.label){k.attr("selected","selected")}}})}});console.log(b)};DTGADGET.issueTypesPicker=function(e,a,d,b,c){return{userpref:d,label:"Issue Types:",id:"issuetype_picker_"+d,type:"callbackBuilder",callback:function(i){var f={id:d,name:d};var h="select";if(b){f.multiple="multiple";f.size="4";h="multi-select"}i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+a);DTGADGET.updateIssueTypeSelectionOptions(e,g.val(),d,c);g.change(function(j){DTGADGET.updateIssueTypeSelectionOptions(e,g.val(),d,c)})}}};DTGADGET.populateOuthDetail=function(d,c,a,b){return{userpref:c,label:c,id:"project_picker_"+c,type:"hidden",value:b.qmetryUid}};DTGADGET.ITSM_sgPicker=function(c,b,a){return{userpref:b,label:"Solution Groups",id:"sg_picker_"+b,type:"callbackBuilder",callback:function(h){var d={id:b,name:b};var f="select";if(true){d.multiple="multiple";d.size="4";f="multi-select"}h.append(AJS.$("<select>").attr(d).addClass(f));var e=AJS.$("#"+b);e.empty();var i=c.getPref(b);var g=i.split("|");AJS.$(a).each(function(){var j=AJS.$("<option/>").attr("value",this.value).text(this.value);e.append(j);if(AJS.$.inArray(this.value,g)>-1){j.attr({selected:"selected"});selectedProjectId=this.value}})}}};DTGADGET.DLR_updateVersionSelectionOptions=function(c,a,h,e){var g=AJS.$("#"+h);g.empty();var b;if(a===null){return}else{if(a.length>1){var i=0;for(var f=0,d=a.length;f<d;f++){b=AJS.$.ajax({key:"versions",url:"/rest/api/2/project/"+a[f]+"/versions",contentType:"application/json",success:function(k){var j=c.getPref(h).split("|");console.log("Selected Versions: "+j.toString());b=k;if(i==0){b.unshift({id:"All",name:"All Versions"});i=1}AJS.$(b).each(function(){var n=AJS.$("<option/>").attr("value",this.id).text(this.name);g.append(n);for(var o=0,m=j.length;o<m;o++){if(j[o]==this.id){n.attr("selected","selected")}}})}})}}else{b=AJS.$.ajax({key:"versions",url:"/rest/api/2/project/"+a+"/versions",contentType:"application/json",success:function(k){var j=c.getPref(h).split("|");console.log("Selected Versions: "+j.toString());b=k;if(e){b.unshift({id:"All",name:"All Versions"})}AJS.$(b).each(function(){var n=AJS.$("<option/>").attr("value",this.id).text(this.name);g.append(n);for(var o=0,m=j.length;o<m;o++){if(j[o]==this.id){n.attr("selected","selected")}}})}})}}console.log(g)};DTGADGET.DLR_versionPicker=function(e,a,d,b,c){return{userpref:d,label:e.getMsg("Version"),id:"version_picker_"+d,type:"callbackBuilder",callback:function(i){var f={id:d,name:d};var h="select";if(b){f.multiple="multiple";f.size="4";h="multi-select"}i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+a);DTGADGET.DLR_updateVersionSelectionOptions(e,g.val(),d,c);g.change(function(j){DTGADGET.DLR_updateVersionSelectionOptions(e,g.val(),d,c)})}}};DTGADGET.DLR_sprintPicker=function(e,b,c,a,d){return{userpref:c,label:e.getMsg("Sprint"),id:"sprint_picker_"+c,type:"callbackBuilder",callback:function(i){var f={id:c,name:c};var h="select";if(a){f.multiple="multiple";f.size="4";h="multi-select"}i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+b);DTGADGET.DLR_updateSprintSelectionOptions(e,g.val(),c,d);g.change(function(j){DTGADGET.DLR_updateSprintSelectionOptions(e,g.val(),c,d)})}}};DTGADGET.DLR_updateSprintSelectionOptions=function(f,e,b,c){e="project in("+e+")";var a=AJS.$("#"+b);a.empty();var d=AJS.$.ajax({key:"sprints",url:"/rest/greenhopper/1.0/integration/teamcalendars/sprint/list",contentType:"application/json",data:{jql:e,returnIds:true},success:function(h){var g=f.getPref(b).split("|");d=h.sprints;if(c){d.unshift({id:"All",name:"All Sprints"})}AJS.$(d).each(function(){var k=AJS.$("<option/>").attr("value",this.id).text(this.name);a.append(k);for(var m=0,j=g.length;m<j;m++){if(g[m]==this.id){k.attr("selected","selected")}}})}})};DTGADGET.updateITSMIssueTypeSelectionOptions=function(f,e,d,c){var b=AJS.$("#"+d);b.empty();var a=AJS.$.ajax({key:"issueTypes",url:"/rest/incident/1.0/getIssueTypes.json?projectkey="+e,contentType:"application/json",success:function(h){var g=f.getPref(d).split("|");a=h;if(c){a.unshift({label:"All",value:"All Versions"})}AJS.$(a).each(function(){var k=AJS.$("<option/>").attr("value",this.label).text(this.value);b.append(k);for(var m=0,j=g.length;m<j;m++){if(g[m]==this.label){k.attr("selected","selected")}}})}});console.log(b)};DTGADGET.updateITSMStatusSelectionOptions=function(f,e,c,g,d){var b=AJS.$("#"+g);b.empty();var a=AJS.$.ajax({key:"status",url:"/rest/incident/1.0/getStatusTypes.json?projectkey="+e+"&issueType="+c,contentType:"application/json",success:function(i){var h=f.getPref(g).split("|");a=i;AJS.$(a).each(function(m){var k=AJS.$("<option/>").attr("value",this.label).text(this.value);b.append(k);for(var n=0,j=h.length;n<j;n++){if(h[n]==this.label){k.attr("selected","selected");selectedProjectId=this.value}}})}})};DTGADGET.ITSMstatusPicker=function(c,a,b,d){return{userpref:d,label:"Status:",id:"status_picker_"+d,type:"callbackBuilder",callback:function(i){var e={id:d,name:d};var g="multi-select";e.multiple="multiple";e.size="4";i.append(AJS.$("<select>").attr(e).addClass(g));var h=AJS.$("#"+b);var f=AJS.$("#"+a);DTGADGET.updateITSMStatusSelectionOptions(c,f.val(),h.val(),d);f.change(function(j){DTGADGET.updateITSMStatusSelectionOptions(c,f.val(),h.val(),d)});h.change(function(j){DTGADGET.updateITSMStatusSelectionOptions(c,f.val(),h.val(),d)})}}};DTGADGET.ITSMissueTypesPicker=function(e,a,d,b,c){return{userpref:d,label:"Issue Types:",id:"issuetype_picker_"+d,type:"callbackBuilder",callback:function(i){var f={id:d,name:d};var h="select";i.append(AJS.$("<select>").attr(f).addClass(h));var g=AJS.$("#"+a);DTGADGET.updateITSMIssueTypeSelectionOptions(e,g.val(),d,c);g.change(function(j){DTGADGET.updateITSMIssueTypeSelectionOptions(e,g.val(),d,c)})}}};DTGADGET.updateITSMstatusPicker_incident=function(f,e,c,g,d){var b=AJS.$("#"+g);b.empty();var a=AJS.$.ajax({key:"status",url:"/rest/incident/1.0/getStatusTypes.json?projectkey="+e+"&issueType="+c,contentType:"application/json",success:function(i){var h=f.getPref(g).split("|");a=i;AJS.$(a).each(function(m){var k=AJS.$("<option/>").attr("value",this.label).text(this.value);b.append(k);for(var n=0,j=h.length;n<j;n++){if(h[n]==this.label){k.attr("selected","selected");selectedProjectId=this.value}}})}})};DTGADGET.ITSMstatusPicker_incident=function(b,c,a,d){return{userpref:d,label:"Status:",id:"status_picker_"+d,type:"callbackBuilder",callback:function(g){var e={id:d,name:d};var f="multi-select";e.multiple="multiple";e.size="4";g.append(AJS.$("<select>").attr(e).addClass(f));DTGADGET.updateITSMstatusPicker_incident(b,c,a,d)}}};
AJS.toInit(function(){RoleBasedMapper.getAllRoleBasedMappings();AJS.$("#dialog-show-button").click(function(){AJS.dialog2("#demo-dialog").show()});AJS.$("#dialog-close-button").click(function(f){f.preventDefault();AJS.dialog2("#demo-dialog").hide()});AJS.$("#rolebasedmapping-dialog-save-button").click(function(){if(d()){RoleBasedMapper.addRoleBasedMapping();AJS.dialog2("#demo-dialog").hide()}});AJS.$(".deleteRoleBasedMapping").live("click",function(){var f=AJS.$(this).closest("tr");var e=[];AJS.$(this).closest("tr").find("td").each(function(){e.push(AJS.$(this).text())});AJS.log("Field to delete for Project Key "+e[0]);AJS.log("Field to delete for Issue Type "+e[1]);AJS.log("Field to delete for Solution Group "+e[2]);AJS.log("Field to delete for Project Role "+e[3]);AJS.log("Delete Mapping dialog pops up");AJS.dialog2("#delete-dialog").show();AJS.$("#projectKeyConf").text(e[0]);AJS.$("#issueTypeConf").text(e[1]);AJS.$("#solutionGroupConf").text(e[2]);AJS.$("#projectRoleConf").text(e[3])});AJS.$("#rolebasedmapping-dialog-delete-cancel-link").click(function(f){f.preventDefault();AJS.dialog2("#delete-dialog").hide()});AJS.$("#rolebasedmapping-dialog-delete-button").click(function(){RoleBasedMapper.removeRoleBasedMapping(AJS.$("#projectKeyConf").text(),AJS.$("#issueTypeConf").text(),AJS.$("#solutionGroupConf").text(),AJS.$("#projectRoleConf").text());AJS.dialog2("#delete-dialog").hide()});function d(){var g,i,l,h;AJS.$(".error").html("");var j=AJS.$("#selectedProjects").val();var k=AJS.$("#selectedIssueTypes").val();var f=AJS.$("#selectedSolutionGroups").val();var e=AJS.$("#selectedProjectRoles").val();if(!j){g=AJS.I18n.getText("com.dt.jira.project.rolebased.mapping.dialog.errorprojectkey")}if(!k){i=AJS.I18n.getText("com.dt.jira.project.rolebased.mapping.dialog.errorissuetype")}if(!f){l=AJS.I18n.getText("com.dt.jira.project.rolebased.mapping.dialog.errorsolutiongroup")}if(!e){h=AJS.I18n.getText("com.dt.jira.project.rolebased.mapping.dialog.errorprojectrole")}if(g){AJS.$("#selectedProjects").focus().siblings(".error").html(g);return false}if(i){AJS.$("#selectedIssueTypes").focus().siblings(".error").html(i);return false}if(l){AJS.$("#selectedSolutionGroups").focus().siblings(".error").html(l);return false}if(h){AJS.$("#selectedProjectRoles").focus().siblings(".error").html(h);return false}return true}var c=AJS.$("#baseURL").val();a();function a(){var e=AJS.$("#selectedProjects").find("option:selected").val();AJS.$.ajax({url:"/rest/rolebasedmap/1.0/ProjectRoles/getIssueTypes",type:"GET",contentType:"application/json",data:{projectKey:e},success:function(f){var h=f==null?[]:(f instanceof Array?f:[f]);AJS.$("#selectedIssueTypes").empty();var g=AJS.$("<option/>").attr("value","").text("--Select Issue Type--");AJS.$.each(h,function(j,i){g=AJS.$("<option/>").attr("value",i.value).text(i.label);AJS.$("#selectedIssueTypes").append(g)});b()}})}AJS.$("#selectedProjects").change(function(f){f.preventDefault();a();b()});AJS.$("#selectedIssueTypes").change(function(f){f.preventDefault();b()});function b(){var f=AJS.$("#selectedProjects").find("option:selected").val();var e=AJS.$("#selectedIssueTypes").find("option:selected").text();AJS.$.ajax({url:"/rest/rolebasedmap/1.0/ProjectRoles/getAllSolGrpMap",type:"GET",contentType:"application/json",data:{projectKey:f,issueType:e},success:function(g){var i=g==null?[]:(g instanceof Array?g:[g]);AJS.$("#selectedSolutionGroups").empty();var h=AJS.$("<option/>").attr("value","").text("--Select Solution Group--");AJS.$.each(i,function(j,k){h=AJS.$("<option/>").attr("value",k.value).text(k.label);AJS.$("#selectedSolutionGroups").append(h)})}})}});
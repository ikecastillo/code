AJS.toInit(function(){PISDMapper.getAllMappings();function g(){AJS.$.ajax({url:"/rest/pisd-ticket-creator-api/1.0/pisdadminconfig",type:"PUT",contentType:"application/json",data:'{"pisdTicketUid": "'+AJS.$("#pisdticketuid").attr("value")+'", "pisdTicketPwd": "'+AJS.$("#pisdticketpwd").attr("value")+'","pisdticketSDApplicationName": "'+AJS.$("#pisdticketSDApplicationName option:selected").text()+'"}',processData:false})}AJS.$("#pistticketadmin2").submit(function(h){h.preventDefault();g();JIRA.Messages.showSuccessMsg("Plugin Configuration Saved Successfully!")});AJS.$("#pisd-mapping-button").click(function(){AJS.log("Mapping dialog pops up");AJS.dialog2("#pisdtktmapping-dialog").show();AJS.$(".error").html("");AJS.$("#solngroupITIM > option:eq(0)").prop("selected",true);AJS.$("#productITIM > option:eq(0)").prop("selected",true);AJS.$("#subproductITIM > option:eq(0)").prop("selected",true);AJS.$("#serviceDeskId").val("");AJS.$("#requestTypeId").val("");AJS.$("#custfieldWithId").val("");e("ITIM");AJS.$("#solngroupITIM").change(function(){var h=AJS.$("#solngroupITIM").val();if(h!="Select"){f("ITIM",h)}else{a()}});AJS.$("#productITIM").change(function(){var i=AJS.$("#solngroupITIM").val();var h=AJS.$("#productITIM").val();if(h!="Select"){d("ITIM",i,h)}else{c()}});AJS.log("Mapping dialog ready to accept form inputs")});AJS.$("#pisdmapping-dialog-cancel-link").click(function(h){h.preventDefault();AJS.dialog2("#pisdtktmapping-dialog").hide();AJS.log("Mapping dialog hides")});AJS.$("#pisdmapping-dialog-add-button").click(function(){if(b()){PISDMapper.addMapping();AJS.dialog2("#pisdtktmapping-dialog").hide()}});AJS.$(".deletePisdMapping").live("click",function(){var h=[];AJS.$(this).closest("tr").find("td").each(function(){h.push(AJS.$(this).text())});AJS.log("Delete Mapping dialog pops up");AJS.dialog2("#pisdtktdelete-mapping-dialog").show();AJS.$("#serviceDeskIdconf").text(h[0]);AJS.$("#serviceDeskNameconf").text(h[1]);AJS.$("#requestTypeIdIdconf").text(h[2]);AJS.$("#requestTypeNameconf").text(h[3]);AJS.$("#customfieldswithIdsconf").text(h[4])});AJS.$("#pisdmapping-dialog-delete-cancel-link").click(function(h){h.preventDefault();AJS.dialog2("#pisdtktdelete-mapping-dialog").hide();AJS.log("Delete Mapping dialog hides")});AJS.$("#pisdmapping-dialog-delete-button").click(function(){PISDMapper.removeMapping(AJS.$("#serviceDeskIdconf").text(),AJS.$("#serviceDeskNameconf").text(),AJS.$("#requestTypeIdIdconf").text(),AJS.$("#requestTypeNameconf").text(),AJS.$("#customfieldswithIdsconf").text());AJS.dialog2("#pisdtktdelete-mapping-dialog").hide()});function e(h){AJS.$.ajax({url:AJS.params.baseURL+"/rest/xmatter-integration/1.0/getSolutionGroups",type:"GET",contentType:"application/json",data:{projectkey:h},async:false,success:function(m){var n=AJS.$("#solngroupITIM");AJS.$("option",n).not(":eq(0)").remove();for(var k=0;k<m.length;k++){var l=m[k].value;var j=AJS.$("<option/>").attr("value",l).text(l);n.append(j)}}})}function f(h,i){AJS.$.ajax({url:AJS.params.baseURL+"/rest/incident/1.0/getTypes/getProductValues",type:"GET",contentType:"application/json",data:{solutionGroup:i,projectkey:h},async:false,success:function(n){var k=AJS.$("#productITIM");AJS.$("option",k).not(":eq(0)").remove();for(var j=0;j<n.length;j++){var m=n[j].value;var l=AJS.$("<option/>").attr("value",m).text(m);k.append(l)}}})}function d(i,j,h){AJS.$.ajax({url:AJS.params.baseURL+"/rest/pisd-ticket-creator-api/1.0/subProducts/getSubProductValues",type:"GET",contentType:"application/json",data:{solutionGroup:j,projectkey:i,product:h},async:false,success:function(o){var k=AJS.$("#subproductITIM");AJS.$("option",k).not(":eq(0)").remove();for(var l=0;l<o.length;l++){var n=o[l].value;var m=AJS.$("<option/>").attr("value",n).text(n);k.append(m)}}})}function a(){var h=AJS.$("#productITIM");AJS.$("option",h).not(":eq(0)").remove();c()}function c(){var h=AJS.$("#subproductITIM");AJS.$("option",h).not(":eq(0)").remove()}function b(){var j=true;var m=AJS.$("#productITIM option:selected").text();var l=AJS.$("#subproductITIM option:selected").text();var i=AJS.$("#serviceDeskId").val().trim();var k=AJS.$("#requestTypeId").val().trim();var h=AJS.$("#custfieldWithId").val().trim();if(m=="Select"){AJS.$("#productITIM").focus().siblings(".error").html("Please select a Product");j=false}if(l=="Select"){AJS.$("#subproductITIM").focus().siblings(".error").html("Please select a Sub Product");j=false}if(!i){AJS.$("#serviceDeskId").focus().siblings(".error").html("Please enter the Service Desk ID");j=false}if(!k){AJS.$("#requestTypeId").focus().siblings(".error").html("Please enter the Request Type ID");j=false}return j}});
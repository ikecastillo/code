(function(a){a.fn.tableToJSON=function(b){var d={ignoreColumns:[],onlyColumns:null,ignoreHiddenRows:true,headings:null,allowHTML:false,includeRowId:false};b=a.extend(d,b);var e=function(l){return l!==undefined&&l!==null};var c=function(l){if(e(b.onlyColumns)){return a.inArray(l,b.onlyColumns)===-1}return a.inArray(l,b.ignoreColumns)!==-1};var g=function(o,m){var l={},n=0;a.each(m,function(p,q){if(n<o.length&&e(q)){l[o[n]]=q;n++}});return l};var h=function(n,m){var p,l;var o=a(m).data("override");if(b.allowHTML){p=a.trim(a(m).html())}else{p=a.trim(a(m).text())}l=e(o)?o:p;return l};var k=function(p){var l=[];var m=b.includeRowId;var o=(typeof m==="boolean")?m:(typeof m==="string")?true:false;var n=(typeof m==="string")===true?m:"rowId";if(o){if(typeof a(p).attr("id")==="undefined"){l.push(n)}}a(p).children("td,th").each(function(r,q){l.push(h(r,q))});return l};var f=function(l){var m=l.find("tr:first").first();return e(b.headings)?b.headings:k(m)};var j=function(u,t){var n,m,p,l,o,q,s,w=[],r=0,v=[];u.children("tbody,*").children("tr").each(function(A,z){if(A>0||e(b.headings)){var x=b.includeRowId;var y=(typeof x==="boolean")?x:(typeof x==="string")?true:false;q=a(z);if(q.is(":visible")||!b.ignoreHiddenRows){r=0;if(!w[A]){w[A]=[]}if(y){r=r+1;if(typeof q.attr("id")!=="undefined"){w[A].push(q.attr("id"))}else{w[A].push("")}}q.children().each(function(){s=a(this);if(s.filter("[rowspan]").length){p=parseInt(s.attr("rowspan"),10)-1;o=h(r,s,[]);for(n=1;n<=p;n++){if(!w[A+n]){w[A+n]=[]}w[A+n][r]=o}}if(s.filter("[colspan]").length){p=parseInt(s.attr("colspan"),10)-1;o=h(r,s,[]);for(n=1;n<=p;n++){if(s.filter("[rowspan]").length){l=parseInt(s.attr("rowspan"),10);for(m=0;m<l;m++){w[A+m][r+n]=o}}else{w[A][r+n]=o}}}while(w[A][r]){r++}o=w[A][r]||h(r,s,[]);if(e(o)){w[A][r]=o}r++})}}});a.each(w,function(z,A){if(e(A)){var x=e(b.onlyColumns)||b.ignoreColumns.length?a.grep(A,function(B,C){return !c(C)}):A,y=e(b.headings)?t:a.grep(t,function(B,C){return !c(C)});o=g(y,x);v[v.length]=o}});return v};var i=f(this);return j(this,i)}})(AJS.$||jQuery);
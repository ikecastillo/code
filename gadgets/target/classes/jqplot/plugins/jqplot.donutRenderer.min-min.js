(function(v){v.jqplot.DonutRenderer=function(){v.jqplot.LineRenderer.call(this)};v.jqplot.DonutRenderer.prototype=new v.jqplot.LineRenderer();v.jqplot.DonutRenderer.prototype.constructor=v.jqplot.DonutRenderer;v.jqplot.DonutRenderer.prototype.init=function(e,a){this.diameter=null;this.innerDiameter=null;this.thickness=null;this.padding=20;this.sliceMargin=0;this.ringMargin=null;this.fill=true;this.shadowOffset=2;this.shadowAlpha=0.07;this.shadowDepth=5;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.dataLabels="percent";this.showDataLabels=false;this.dataLabelFormatString=null;this.dataLabelThreshold=3;this.dataLabelPositionFactor=0.4;this.dataLabelNudge=0;this.startAngle=0;this.tickRenderer=v.jqplot.DonutTickRenderer;this._drawData=true;this._type="donut";if(e.highlightMouseDown&&e.highlightMouseOver==null){e.highlightMouseOver=false}v.extend(true,this,e);if(this.diameter!=null){this.diameter=this.diameter-this.sliceMargin}this._diameter=null;this._innerDiameter=null;this._radius=null;this._innerRadius=null;this._thickness=null;this._previousSeries=[];this._numberSeries=1;this._sliceAngles=[];this._highlightedPoint=null;if(this.highlightColors.length==0){for(var c=0;c<this.seriesColors.length;c++){var d=v.jqplot.getColorComponents(this.seriesColors[c]);var g=[d[0],d[1],d[2]];var b=g[0]+g[1]+g[2];for(var f=0;f<3;f++){g[f]=(b>570)?g[f]*0.8:g[f]+0.3*(255-g[f]);g[f]=parseInt(g[f],10)}this.highlightColors.push("rgb("+g[0]+","+g[1]+","+g[2]+")")}}a.postParseOptionsHooks.addOnce(o);a.postInitHooks.addOnce(t);a.eventListenerHooks.addOnce("jqplotMouseMove",y);a.eventListenerHooks.addOnce("jqplotMouseDown",z);a.eventListenerHooks.addOnce("jqplotMouseUp",q);a.eventListenerHooks.addOnce("jqplotClick",u);a.eventListenerHooks.addOnce("jqplotRightClick",n);a.postDrawHooks.addOnce(s)};v.jqplot.DonutRenderer.prototype.setGridData=function(b){var f=[];var a=[];var g=this.startAngle/180*Math.PI;var c=0;this._drawData=false;for(var d=0;d<this.data.length;d++){if(this.data[d][1]!=0){this._drawData=true}f.push(this.data[d][1]);a.push([this.data[d][0]]);if(d>0){f[d]+=f[d-1]}c+=this.data[d][1]}var e=Math.PI*2/f[f.length-1];for(var d=0;d<f.length;d++){a[d][1]=f[d]*e;a[d][2]=this.data[d][1]/c}this.gridData=a};v.jqplot.DonutRenderer.prototype.makeGridData=function(c,b){var g=[];var a=[];var d=0;var h=this.startAngle/180*Math.PI;this._drawData=false;for(var e=0;e<c.length;e++){if(this.data[e][1]!=0){this._drawData=true}g.push(c[e][1]);a.push([c[e][0]]);if(e>0){g[e]+=g[e-1]}d+=c[e][1]}var f=Math.PI*2/g[g.length-1];for(var e=0;e<g.length;e++){a[e][1]=g[e]*f;a[e][2]=c[e][1]/d}return a};v.jqplot.DonutRenderer.prototype.drawSlice=function(e,h,i,b,j){var d=this._diameter/2;var g=d-this._thickness;var f=this.fill;e.save();e.translate(this._center[0],this._center[1]);if(j){for(var a=0;a<this.shadowDepth;a++){e.save();e.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));c()}}else{c()}function c(){if(i>6.282+this.startAngle){i=6.282+this.startAngle;if(h>i){h=6.281+this.startAngle}}if(h>=i){return}e.beginPath();e.fillStyle=b;e.strokeStyle=b;e.arc(0,0,d,h,i,false);e.lineTo(g*Math.cos(i),g*Math.sin(i));e.arc(0,0,g,i,h,true);e.closePath();if(f){e.fill()}else{e.stroke()}}if(j){for(var a=0;a<this.shadowDepth;a++){e.restore()}}e.restore()};v.jqplot.DonutRenderer.prototype.draw=function(k,c,ai,i){var h;var aa=(ai!=undefined)?ai:{};var an=0;var ap=0;var ag=1;if(ai.legendInfo&&ai.legendInfo.placement=="insideGrid"){var ab=ai.legendInfo;switch(ab.location){case"nw":an=ab.width+ab.xoffset;break;case"w":an=ab.width+ab.xoffset;break;case"sw":an=ab.width+ab.xoffset;break;case"ne":an=ab.width+ab.xoffset;ag=-1;break;case"e":an=ab.width+ab.xoffset;ag=-1;break;case"se":an=ab.width+ab.xoffset;ag=-1;break;case"n":ap=ab.height+ab.yoffset;break;case"s":ap=ab.height+ab.yoffset;ag=-1;break;default:break}}var am=(aa.shadow!=undefined)?aa.shadow:this.shadow;var b=(aa.showLine!=undefined)?aa.showLine:this.showLine;var j=(aa.fill!=undefined)?aa.fill:this.fill;var ak=k.canvas.width;var ac=k.canvas.height;var ae=ak-an-2*this.padding;var g=ac-ap-2*this.padding;var ad=Math.min(ae,g);var e=ad;var a=(this.ringMargin==null)?this.sliceMargin*2:this.ringMargin;for(var h=0;h<this._previousSeries.length;h++){e-=2*this._previousSeries[h]._thickness+2*a}this._diameter=this.diameter||e;if(this.innerDiameter!=null){var l=(this._numberSeries>1&&this.index>0)?this._previousSeries[0]._diameter:this._diameter;this._thickness=this.thickness||(l-this.innerDiameter-2*a*this._numberSeries)/this._numberSeries/2}else{this._thickness=this.thickness||ad/2/(this._numberSeries+1)*0.85}var Z=this._radius=this._diameter/2;this._innerRadius=this._radius-this._thickness;var aq=this.startAngle/180*Math.PI;this._center=[(ak-ag*an)/2+ag*an,(ac-ag*ap)/2+ag*ap];if(this.shadow){var m="rgba(0,0,0,"+this.shadowAlpha+")";for(var h=0;h<c.length;h++){var ao=(h==0)?aq:c[h-1][1]+aq;ao+=this.sliceMargin/180*Math.PI;this.renderer.drawSlice.call(this,k,ao,c[h][1]+aq,m,true)}}for(var h=0;h<c.length;h++){var ao=(h==0)?aq:c[h-1][1]+aq;ao+=this.sliceMargin/180*Math.PI;var Y=c[h][1]+aq;this._sliceAngles.push([ao,Y]);this.renderer.drawSlice.call(this,k,ao,Y,this.seriesColors[h],false);if(this.showDataLabels&&c[h][2]*100>=this.dataLabelThreshold){var f,d=(ao+Y)/2,al;if(this.dataLabels=="label"){f=this.dataLabelFormatString||"%s";al=v.jqplot.sprintf(f,c[h][0])}else{if(this.dataLabels=="value"){f=this.dataLabelFormatString||"%d";al=v.jqplot.sprintf(f,this.data[h][1])}else{if(this.dataLabels=="percent"){f=this.dataLabelFormatString||"%d%%";al=v.jqplot.sprintf(f,c[h][2]*100)}else{if(this.dataLabels.constructor==Array){f=this.dataLabelFormatString||"%s";al=v.jqplot.sprintf(f,this.dataLabels[h])}}}}var ar=this._innerRadius+this._thickness*this.dataLabelPositionFactor+this.sliceMargin+this.dataLabelNudge;var af=this._center[0]+Math.cos(d)*ar+this.canvas._offsets.left;var ah=this._center[1]+Math.sin(d)*ar+this.canvas._offsets.top;var aj=v('<span class="jqplot-donut-series jqplot-data-label" style="position:absolute;">'+al+"</span>").insertBefore(i.eventCanvas._elem);af-=aj.width()/2;ah-=aj.height()/2;af=Math.round(af);ah=Math.round(ah);aj.css({left:af,top:ah})}}};v.jqplot.DonutAxisRenderer=function(){v.jqplot.LinearAxisRenderer.call(this)};v.jqplot.DonutAxisRenderer.prototype=new v.jqplot.LinearAxisRenderer();v.jqplot.DonutAxisRenderer.prototype.constructor=v.jqplot.DonutAxisRenderer;v.jqplot.DonutAxisRenderer.prototype.init=function(a){this.tickRenderer=v.jqplot.DonutTickRenderer;v.extend(true,this,a);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=false;this.ticks=[];this.showMark=false;this.show=false};v.jqplot.DonutLegendRenderer=function(){v.jqplot.TableLegendRenderer.call(this)};v.jqplot.DonutLegendRenderer.prototype=new v.jqplot.TableLegendRenderer();v.jqplot.DonutLegendRenderer.prototype.constructor=v.jqplot.DonutLegendRenderer;v.jqplot.DonutLegendRenderer.prototype.init=function(a){this.numberRows=null;this.numberColumns=null;v.extend(true,this,a)};v.jqplot.DonutLegendRenderer.prototype.draw=function(){var I=this;if(this.show){var b=this._series;var H="position:absolute;";H+=(this.background)?"background:"+this.background+";":"";H+=(this.border)?"border:"+this.border+";":"";H+=(this.fontSize)?"font-size:"+this.fontSize+";":"";H+=(this.fontFamily)?"font-family:"+this.fontFamily+";":"";H+=(this.textColor)?"color:"+this.textColor+";":"";H+=(this.marginTop!=null)?"margin-top:"+this.marginTop+";":"";H+=(this.marginBottom!=null)?"margin-bottom:"+this.marginBottom+";":"";H+=(this.marginLeft!=null)?"margin-left:"+this.marginLeft+";":"";H+=(this.marginRight!=null)?"margin-right:"+this.marginRight+";":"";this._elem=v('<table class="jqplot-table-legend" style="'+H+'"></table>');var g=false,c=false,M,f;var a=b[0];var L=new v.jqplot.ColorGenerator(a.seriesColors);if(a.show){var e=a.data;if(this.numberRows){M=this.numberRows;if(!this.numberColumns){f=Math.ceil(e.length/M)}else{f=this.numberColumns}}else{if(this.numberColumns){f=this.numberColumns;M=Math.ceil(e.length/this.numberColumns)}else{M=e.length;f=1}}var i,k,K,j,m,h,d,l;var J=0;for(i=0;i<M;i++){if(c){K=v('<tr class="jqplot-table-legend"></tr>').prependTo(this._elem)}else{K=v('<tr class="jqplot-table-legend"></tr>').appendTo(this._elem)}for(k=0;k<f;k++){if(J<e.length){h=this.labels[J]||e[J][0].toString();l=L.next();if(!c){if(i>0){g=true}else{g=false}}else{if(i==M-1){g=false}else{g=true}}d=(g)?this.rowSpacing:"0";j=v('<td class="jqplot-table-legend" style="text-align:center;padding-top:'+d+';"><div><div class="jqplot-table-legend-swatch" style="border-color:'+l+';"></div></div></td>');m=v('<td class="jqplot-table-legend" style="padding-top:'+d+';"></td>');if(this.escapeHtml){m.text(h)}else{m.html(h)}if(c){m.prependTo(K);j.prependTo(K)}else{j.appendTo(K);m.appendTo(K)}g=true}J++}}}}return this._elem};function x(a,b,d){d=d||{};d.axesDefaults=d.axesDefaults||{};d.legend=d.legend||{};d.seriesDefaults=d.seriesDefaults||{};var e=false;if(d.seriesDefaults.renderer==v.jqplot.DonutRenderer){e=true}else{if(d.series){for(var c=0;c<d.series.length;c++){if(d.series[c].renderer==v.jqplot.DonutRenderer){e=true}}}}if(e){d.axesDefaults.renderer=v.jqplot.DonutAxisRenderer;d.legend.renderer=v.jqplot.DonutLegendRenderer;d.legend.preDraw=true;d.seriesDefaults.pointLabels={show:false}}}function t(a,b,d){for(var c=1;c<this.series.length;c++){if(!this.series[c]._previousSeries.length){for(var e=0;e<c;e++){if(this.series[c].renderer.constructor==v.jqplot.DonutRenderer&&this.series[e].renderer.constructor==v.jqplot.DonutRenderer){this.series[c]._previousSeries.push(this.series[e])}}}}for(c=0;c<this.series.length;c++){if(this.series[c].renderer.constructor==v.jqplot.DonutRenderer){this.series[c]._numberSeries=this.series.length;if(this.series[c].highlightMouseOver){this.series[c].highlightMouseDown=false}}}}var p=false;function o(b){for(var a=0;a<this.series.length;a++){this.series[a].seriesColors=this.seriesColors;this.series[a].colorGenerator=v.jqplot.colorGenerator}}function w(a,b,c){var d=a.series[b];var e=a.plugins.donutRenderer.highlightCanvas;e._ctx.clearRect(0,0,e._ctx.canvas.width,e._ctx.canvas.height);d._highlightedPoint=c;a.plugins.donutRenderer.highlightedSeriesIndex=b;d.renderer.drawSlice.call(d,e._ctx,d._sliceAngles[c][0],d._sliceAngles[c][1],d.highlightColors[c],false)}function r(a){var c=a.plugins.donutRenderer.highlightCanvas;c._ctx.clearRect(0,0,c._ctx.canvas.width,c._ctx.canvas.height);for(var b=0;b<a.series.length;b++){a.series[b]._highlightedPoint=null}a.plugins.donutRenderer.highlightedSeriesIndex=null;a.target.trigger("jqplotDataUnhighlight")}function y(d,e,a,b,c){if(b){var f=[b.seriesIndex,b.pointIndex,b.data];var g=jQuery.Event("jqplotDataMouseOver");g.pageX=d.pageX;g.pageY=d.pageY;c.target.trigger(g,f);if(c.series[f[0]].highlightMouseOver&&!(f[0]==c.plugins.donutRenderer.highlightedSeriesIndex&&f[1]==c.series[f[0]]._highlightedPoint)){var h=jQuery.Event("jqplotDataHighlight");h.which=d.which;h.pageX=d.pageX;h.pageY=d.pageY;c.target.trigger(h,f);w(c,f[0],f[1])}}else{if(b==null){r(c)}}}function z(d,e,a,b,c){if(b){var f=[b.seriesIndex,b.pointIndex,b.data];if(c.series[f[0]].highlightMouseDown&&!(f[0]==c.plugins.donutRenderer.highlightedSeriesIndex&&f[1]==c.series[f[0]]._highlightedPoint)){var g=jQuery.Event("jqplotDataHighlight");g.which=d.which;g.pageX=d.pageX;g.pageY=d.pageY;c.target.trigger(g,f);w(c,f[0],f[1])}}else{if(b==null){r(c)}}}function q(d,e,a,b,c){var f=c.plugins.donutRenderer.highlightedSeriesIndex;if(f!=null&&c.series[f].highlightMouseDown){r(c)}}function u(d,e,a,b,c){if(b){var f=[b.seriesIndex,b.pointIndex,b.data];var g=jQuery.Event("jqplotDataClick");g.which=d.which;g.pageX=d.pageX;g.pageY=d.pageY;c.target.trigger(g,f)}}function n(d,e,a,b,c){if(b){var f=[b.seriesIndex,b.pointIndex,b.data];var h=c.plugins.donutRenderer.highlightedSeriesIndex;if(h!=null&&c.series[h].highlightMouseDown){r(c)}var g=jQuery.Event("jqplotDataRightClick");g.which=d.which;g.pageX=d.pageX;g.pageY=d.pageY;c.target.trigger(g,f)}}function s(){if(this.plugins.donutRenderer&&this.plugins.donutRenderer.highlightCanvas){this.plugins.donutRenderer.highlightCanvas.resetCanvas();this.plugins.donutRenderer.highlightCanvas=null}this.plugins.donutRenderer={highlightedSeriesIndex:null};this.plugins.donutRenderer.highlightCanvas=new v.jqplot.GenericCanvas();var a=v(this.targetId+" .jqplot-data-label");if(a.length){v(a[0]).before(this.plugins.donutRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-donutRenderer-highlight-canvas",this._plotDimensions,this))}else{this.eventCanvas._elem.before(this.plugins.donutRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-donutRenderer-highlight-canvas",this._plotDimensions,this))}var b=this.plugins.donutRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(c){r(c.data.plot)})}v.jqplot.preInitHooks.push(x);v.jqplot.DonutTickRenderer=function(){v.jqplot.AxisTickRenderer.call(this)};v.jqplot.DonutTickRenderer.prototype=new v.jqplot.AxisTickRenderer();v.jqplot.DonutTickRenderer.prototype.constructor=v.jqplot.DonutTickRenderer})(jQuery);
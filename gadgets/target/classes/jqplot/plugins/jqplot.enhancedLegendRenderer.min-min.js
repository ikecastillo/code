(function(f){f.jqplot.EnhancedLegendRenderer=function(){f.jqplot.TableLegendRenderer.call(this)};f.jqplot.EnhancedLegendRenderer.prototype=new f.jqplot.TableLegendRenderer();f.jqplot.EnhancedLegendRenderer.prototype.constructor=f.jqplot.EnhancedLegendRenderer;f.jqplot.EnhancedLegendRenderer.prototype.init=function(a){this.numberRows=null;this.numberColumns=null;this.seriesToggle="normal";this.seriesToggleReplot=false;this.disableIEFading=true;f.extend(true,this,a);if(this.seriesToggle){f.jqplot.postDrawHooks.push(d)}};f.jqplot.EnhancedLegendRenderer.prototype.draw=function(M,b){var R=this;if(this.show){var F=this._series;var s;var i="position:absolute;";i+=(this.background)?"background:"+this.background+";":"";i+=(this.border)?"border:"+this.border+";":"";i+=(this.fontSize)?"font-size:"+this.fontSize+";":"";i+=(this.fontFamily)?"font-family:"+this.fontFamily+";":"";i+=(this.textColor)?"color:"+this.textColor+";":"";i+=(this.marginTop!=null)?"margin-top:"+this.marginTop+";":"";i+=(this.marginBottom!=null)?"margin-bottom:"+this.marginBottom+";":"";i+=(this.marginLeft!=null)?"margin-left:"+this.marginLeft+";":"";i+=(this.marginRight!=null)?"margin-right:"+this.marginRight+";":"";this._elem=f('<table class="jqplot-table-legend" style="'+i+'"></table>');if(this.seriesToggle){this._elem.css("z-index","3")}var E=false,H=false,T,K;if(this.numberRows){T=this.numberRows;if(!this.numberColumns){K=Math.ceil(F.length/T)}else{K=this.numberColumns}}else{if(this.numberColumns){K=this.numberColumns;T=Math.ceil(F.length/this.numberColumns)}else{T=F.length;K=1}}var G,a,S,N,O,L,J,D,P,Q;var j=0;for(G=F.length-1;G>=0;G--){if(K==1&&F[G]._stack||F[G].renderer.constructor==f.jqplot.BezierCurveRenderer){H=true}}for(G=0;G<T;G++){S=f(document.createElement("tr"));S.addClass("jqplot-table-legend");if(H){S.prependTo(this._elem)}else{S.appendTo(this._elem)}for(a=0;a<K;a++){if(j<F.length&&(F[j].show||F[j].showLabel)){s=F[j];L=this.labels[j]||s.label.toString();if(L){var c=s.color;if(!H){if(G>0){E=true}else{E=false}}else{if(G==T-1){E=false}else{E=true}}J=(E)?this.rowSpacing:"0";N=f(document.createElement("td"));N.addClass("jqplot-table-legend jqplot-table-legend-swatch");N.css({textAlign:"center",paddingTop:J});P=f(document.createElement("div"));P.addClass("jqplot-table-legend-swatch-outline");Q=f(document.createElement("div"));Q.addClass("jqplot-table-legend-swatch");Q.css({backgroundColor:c,borderColor:c});N.append(P.append(Q));O=f(document.createElement("td"));O.addClass("jqplot-table-legend jqplot-table-legend-label");O.css("paddingTop",J);if(this.escapeHtml){O.text(L)}else{O.html(L)}if(H){if(this.showLabels){O.prependTo(S)}if(this.showSwatches){N.prependTo(S)}}else{if(this.showSwatches){N.appendTo(S)}if(this.showLabels){O.appendTo(S)}}if(this.seriesToggle){var I;if(typeof(this.seriesToggle)==="string"||typeof(this.seriesToggle)==="number"){if(!f.jqplot.use_excanvas||!this.disableIEFading){I=this.seriesToggle}}if(this.showSwatches){N.bind("click",{series:s,speed:I,plot:b,replot:this.seriesToggleReplot},e);N.addClass("jqplot-seriesToggle")}if(this.showLabels){O.bind("click",{series:s,speed:I,plot:b,replot:this.seriesToggleReplot},e);O.addClass("jqplot-seriesToggle")}if(!s.show&&s.showLabel){N.addClass("jqplot-series-hidden");O.addClass("jqplot-series-hidden")}}E=true}}j++}N=O=P=Q=null}}return this._elem};var e=function(n){var o=n.data,a=o.series,c=o.replot,p=o.plot,r=o.speed,b=a.index,q=false;if(a.canvas._elem.is(":hidden")||!a.show){q=true}var s=function(){if(c){var h={};if(f.isPlainObject(c)){f.extend(true,h,c)}p.replot(h);if(q&&r){var g=p.series[b];if(g.shadowCanvas._elem){g.shadowCanvas._elem.hide().fadeIn(r)}g.canvas._elem.hide().fadeIn(r);g.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+g.index).hide().fadeIn(r)}}else{var g=p.series[b];if(g.canvas._elem.is(":hidden")||!g.show){if(typeof p.options.legend.showSwatches==="undefined"||p.options.legend.showSwatches===true){p.legend._elem.find("td").eq(b*2).addClass("jqplot-series-hidden")}if(typeof p.options.legend.showLabels==="undefined"||p.options.legend.showLabels===true){p.legend._elem.find("td").eq((b*2)+1).addClass("jqplot-series-hidden")}}else{if(typeof p.options.legend.showSwatches==="undefined"||p.options.legend.showSwatches===true){p.legend._elem.find("td").eq(b*2).removeClass("jqplot-series-hidden")}if(typeof p.options.legend.showLabels==="undefined"||p.options.legend.showLabels===true){p.legend._elem.find("td").eq((b*2)+1).removeClass("jqplot-series-hidden")}}}};a.toggleDisplay(n,s)};var d=function(){if(this.legend.renderer.constructor==f.jqplot.EnhancedLegendRenderer&&this.legend.seriesToggle){var a=this.legend._elem.detach();this.eventCanvas._elem.after(a)}}})(jQuery);
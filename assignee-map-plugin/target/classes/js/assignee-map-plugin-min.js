AJS.toInit(function(){var c=AJS.$("#baseURL").val();AJS.$("#btn_Save").click(function(h){h.preventDefault();if(d()&&b()){var g=AJS.$("#pndappr_10804").find("option:selected").val()==undefined?AJS.$("#pndappr_10804-field").val():AJS.$("#pndappr_10804").find("option:selected").val();var f=AJS.$("#pndappr_10805").find("option:selected").val()==undefined?AJS.$("#pndappr_10805-field").val():AJS.$("#pndappr_10805").find("option:selected").val();if((g==f)&&(g!=""&&g!=null)&&(f!=""&&g!=null)){AJS.$("[id^=pndapprerror_]").each(function(){var i=this.id.substring(this.id.indexOf("_"));AJS.$("#pndapprerror"+i).text("")});JIRA.Messages.showErrorMsg("User should not be the same for "+AJS.$("#lbl_pndappr_ecab1").text()+" and "+AJS.$("#lbl_pndappr_ecab2").text())}else{a()}}});function d(){if(AJS.$("#solutionGroup").find("option:selected").val()!="None"){return true}else{alert("Please select the Solution Group");return false}}function b(){if(AJS.$("#impactedGroup").find("option:selected").val()!="None"){return true}else{alert("Please select the Impacted Group");return false}}AJS.$("#btn_csv").click(function(f){f.preventDefault();AJS.$.ajax({url:c+"/rest/dealertrack/1.0/assignee-mapping/exportassigneecsv",type:"GET",data:{projectKey:AJS.$("#projectKey").val()},success:function(g){window.location.href=c+"/rest/dealertrack/1.0/assignee-mapping/exportassigneecsv?projectKey="+AJS.$("#projectKey").val()},error:function(i,g,h){JIRA.Messages.showErrorMsg("Jira/Assignee Mapping could not be Export!"+i.responseText)}});return false});function a(){AJS.$.ajax({url:c+"/rest/dealertrack/1.0/assignee-mapping",type:"PUT",contentType:"application/json",processData:false,data:e(),success:function(f){if(f==null){AJS.$("[id^=pndapprerror_]").each(function(){var h=this.id.substring(this.id.indexOf("_"));AJS.$("#pndapprerror"+h).text("")});JIRA.Messages.showSuccessMsg("Jira/Assignee Mapping Saved Successfully!")}else{var g=f==null?[]:(f instanceof Array?f:[f]);AJS.$("[id^=pndapprerror_]").each(function(){var h=this.id.substring(this.id.indexOf("_"));AJS.$("#pndapprerror"+h).text("")});AJS.$.each(g,function(i,h){if(h.users==undefined||h.users==""||h.users==null){AJS.$("#pndapprerror_"+h.status).text("User name should not be empty")}else{AJS.$("#pndapprerror_"+h.status).text("User "+h.users+" Does Not Exist")}})}},error:function(h,f,g){JIRA.Messages.showErrorMsg("Jira/Assignee Mapping could not be saved!"+h.responseText)}})}function e(){var o=new Array();var g=[];var n=AJS.$("#pndappr_10800").find("option:selected").val()==undefined?AJS.$("#pndappr_10800-field").val():AJS.$("#pndappr_10800").find("option:selected").val();var m=AJS.$("#pndappr_10801").find("option:selected").val()==undefined?AJS.$("#pndappr_10801-field").val():AJS.$("#pndappr_10801").find("option:selected").val();var l=AJS.$("#pndappr_10802").find("option:selected").val()==undefined?AJS.$("#pndappr_10802-field").val():AJS.$("#pndappr_10802").find("option:selected").val();var k=AJS.$("#pndappr_10803").find("option:selected").val()==undefined?AJS.$("#pndappr_10803-field").val():AJS.$("#pndappr_10803").find("option:selected").val();var i=AJS.$("#pndappr_10804").find("option:selected").val()==undefined?AJS.$("#pndappr_10804-field").val():AJS.$("#pndappr_10804").find("option:selected").val();var h=AJS.$("#pndappr_10805").find("option:selected").val()==undefined?AJS.$("#pndappr_10805-field").val():AJS.$("#pndappr_10805").find("option:selected").val();g.push({status:AJS.$("#pndappr_sme").val(),users:n});g.push({status:AJS.$("#pndappr_sec").val(),users:m});g.push({status:AJS.$("#pndappr_cab").val(),users:l});g.push({status:AJS.$("#pndappr_sch").val(),users:k});g.push({status:AJS.$("#pndappr_ecab1").val(),users:i});g.push({status:AJS.$("#pndappr_ecab2").val(),users:h});for(j=0;j<g.length;j++){var f={projectKey:AJS.$("#projectKey").val(),solutionGroup:AJS.$("#solutionGroup").find("option:selected").val(),impact:AJS.$("#impactedGroup").find("option:selected").val(),status:g[j].status,users:g[j].users};o.push(f)}console.log(JSON.stringify(o));return JSON.stringify(o)}AJS.$("#solutionGroup").change(function(f){if(AJS.$("#solutionGroup").val()!=="None"||AJS.$("#impactGroup").val()!=="None"){AJS.$.ajax({url:c+"/rest/dealertrack/1.0/assignee-mapping",type:"GET",contentType:"application/json",data:{projectKey:AJS.$("#projectKey").val(),solutionGroup:AJS.$("#solutionGroup").find("option:selected").val(),impact:AJS.$("#impactedGroup").find("option:selected").val()},success:function(g){var h=g==null?[]:(g instanceof Array?g:[g]);AJS.$("[id^=pndappr_]").each(function(){var i=this.id.substring(this.id.indexOf("_"));AJS.$("#pndappr"+i+"-field").val("")});AJS.$("[id^=pndapprerror_]").each(function(){var i=this.id.substring(this.id.indexOf("_"));AJS.$("#pndapprerror"+i).text("")});AJS.$.each(h,function(k,i){AJS.$("#pndappr_"+i.status+"-field").val(i.users)})}})}});AJS.$("#impactedGroup").change(function(f){if(AJS.$("#solutionGroup").val()!=="None"||AJS.$("#impactGroup").val()!=="None"){AJS.$.ajax({url:c+"/rest/dealertrack/1.0/assignee-mapping",type:"GET",contentType:"application/json",data:{projectKey:AJS.$("#projectKey").val(),solutionGroup:AJS.$("#solutionGroup").find("option:selected").val(),impact:AJS.$("#impactedGroup").find("option:selected").val()},success:function(g){var h=g==null?[]:(g instanceof Array?g:[g]);AJS.$("[id^=pndappr_]").each(function(){var i=this.id.substring(this.id.indexOf("_"));AJS.$("#pndappr"+i+"-field").val("")});AJS.$("[id^=pndapprerror_]").each(function(){var i=this.id.substring(this.id.indexOf("_"));AJS.$("#pndapprerror"+i).text("")});AJS.$.each(h,function(k,i){AJS.$("#pndappr_"+i.status+"-field").val(i.users)})}})}})});AJS.$(function(){AJS.$("#solutionGroup").auiSelect2();AJS.$("#impactedGroup").auiSelect2()});